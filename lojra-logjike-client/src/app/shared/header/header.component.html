<header class="site-header">
  <div class="header-inner">
    <a routerLink="/" class="logo">
      <img class="logo-icon" src="AL-logo.png" alt="Shqiponja">
      <span class="logo-text">Lojra Logjike</span>
    </a>
    @if (gameHeader.isGamePage()) {
      <nav class="header-nav">
        @if (gameHeader.dayBarVisible()) {
          <button #dayBtn class="header-day-btn" (click)="toggleDayModal()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/>
            </svg>
            {{ gameHeader.selectedDayName() }}
            <svg class="chevron" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="6 9 12 15 18 9"/>
            </svg>
          </button>
        }
        <button class="icon-btn" (click)="onInfo()" title="Si luhet">?</button>
        <button class="icon-btn" (click)="onSettings()" title="Cilësimet">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
          </svg>
        </button>
      </nav>
    } @else {
      <nav class="header-nav">
        <a class="nav-link" (click)="scrollTo('lojrat')">Lojrat</a>
        <a class="nav-link" (click)="scrollTo('rreth')">Rreth</a>
      </nav>
    }
  </div>
</header>

<!-- ── Day Selector Modal (outside header to avoid stacking context) ── -->
@if (showDayModal) {
  <div class="day-modal-overlay" (click)="showDayModal = false"></div>
  <div class="day-modal" [style.top.px]="modalTop" [style.right.px]="modalRight" (click)="$event.stopPropagation()">
    @for (item of gameHeader.dayBarItems(); track item.index) {
      <button
        class="day-modal-item"
        [class.selected]="item.index === gameHeader.dayBarSelectedIndex()"
        [class.completed]="item.completed && item.index !== gameHeader.dayBarSelectedIndex()"
        [class.today]="item.isToday && item.index !== gameHeader.dayBarSelectedIndex()"
        [class.locked]="!item.accessible"
        [disabled]="!item.accessible"
        [style.background]="item.index === gameHeader.dayBarSelectedIndex() ? gameHeader.gameColor() : null"
        (click)="selectDay(item.index)">
        <span class="day-modal-name">{{ item.name }}</span>
        @if (item.completed && item.index !== gameHeader.dayBarSelectedIndex()) {
          <svg class="day-modal-check" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10" fill="#F0FDF4" stroke="#16a34a" stroke-width="1.5"/>
            <polyline points="8 12 11 15 16 9" stroke="#16a34a" stroke-width="2.5"/>
          </svg>
        }
        @if (item.isToday) {
          <span class="day-modal-today-badge">Sot</span>
        }
      </button>
    }
  </div>
}
